<div class="container">
  <section bind:this={home} class="main">
    
    <div class="info-container">

      <div class="info">
        <h3 bind:this={heading1}>Hello, I'm</h3>
        <h1 bind:this={heading2}>Rovie Endigado</h1>
        <h2 bind:this={heading3}>Web Developer</h2>
        <p bind:this={heading4}>Welcome to my portfolio! Here you can find my projects and learn more about me</p>
      </div>

      <div class="image-position">
        <div class="image-container">
          <img src="src\lib\img\profile.png" alt="">
        </div>
      </div>

    </div>
   
    
    <svg viewBox="0 0 884 551" fill="none" xmlns="http://www.w3.org/2000/svg">
      <g class="layer" filter="url(#filter0_d_1_154)">
      <path fill-rule="evenodd" clip-rule="evenodd" d="M841.775 364.827C842.603 374.987 832.678 385.246 812 393L556 489C516.236 503.911 451.764 503.911 412 489L156 393C136.913 385.842 126.988 376.55 126.224 367.172V417.172C126.988 426.55 136.913 435.842 156 443L412 539C451.764 553.911 516.236 553.911 556 539L812 443C832.678 435.246 842.603 424.987 841.775 414.827V364.827Z" fill="#FF0000"/>
      <path fill-rule="evenodd" clip-rule="evenodd" d="M126.225 367.172C125.397 357.013 135.323 346.754 156 339L412 243C451.765 228.088 516.235 228.088 556 243L812 339C831.087 346.158 841.012 355.45 841.776 364.827V414.827C841.012 405.45 831.087 396.158 812 389L556 293C516.235 278.088 451.765 278.088 412 293L156 389C135.323 396.754 125.397 407.013 126.225 417.172V367.172Z" fill="#FF0000"/>
      <g filter="url(#filter1_d_1_154)">
      <path d="M412 243C451.764 228.088 516.236 228.088 556 243L812 339C851.764 353.912 851.764 378.088 812 393L556 489C516.235 503.912 451.765 503.912 412 489L156 393C116.236 378.088 116.236 353.912 156 339L412 243Z" fill="#FF0000"/>
      </g>
      </g>
      <g class="layer" filter="url(#filter2_d_1_154)">
      <path fill-rule="evenodd" clip-rule="evenodd" d="M799.775 256.827C800.603 266.987 790.678 277.246 770 285L514 381C474.236 395.911 409.764 395.911 370 381L114 285C94.913 277.842 84.9879 268.55 84.2245 259.172V309.172C84.9879 318.55 94.913 327.842 114 335L370 431C409.764 445.911 474.236 445.911 514 431L770 335C790.678 327.246 800.603 316.987 799.775 306.827V256.827Z" fill="#FF6600"/>
      <path fill-rule="evenodd" clip-rule="evenodd" d="M84.2245 259.172C83.3975 249.013 93.3227 238.754 114 231L370 135C409.765 120.088 474.235 120.088 514 135L770 231C789.087 238.158 799.012 247.45 799.776 256.827V306.827C799.012 297.45 789.087 288.158 770 281L514 185C474.235 170.088 409.765 170.088 370 185L114 281C93.3227 288.754 83.3975 299.013 84.2245 309.172V259.172Z" fill="#FF6600"/>
      <g filter="url(#filter3_d_1_154)">
      <path d="M370 135C409.764 120.088 474.236 120.088 514 135L770 231C809.764 245.912 809.764 270.088 770 285L514 381C474.235 395.912 409.765 395.912 370 381L114 285C74.2355 270.088 74.2355 245.912 114 231L370 135Z" fill="#FF6600"/>
      </g>
      </g>
      <g class="layer" filter="url(#filter4_d_1_154)">
      <path fill-rule="evenodd" clip-rule="evenodd" d="M757.775 148.827C758.603 158.987 748.678 169.246 728 177L472 273C432.236 287.911 367.764 287.911 328 273L72 177C52.913 169.842 42.9879 160.55 42.2245 151.172V201.172C42.9879 210.55 52.913 219.842 72 227L328 323C367.764 337.911 432.236 337.911 472 323L728 227C748.678 219.246 758.603 208.987 757.775 198.827V148.827Z" fill="#6580E1"/>
      <path fill-rule="evenodd" clip-rule="evenodd" d="M42.2245 151.172C41.3975 141.013 51.3227 130.754 72 123L328 27C367.765 12.0883 432.235 12.0883 472 27L728 123C747.087 130.158 757.012 139.45 757.776 148.827V198.827C757.012 189.45 747.087 180.158 728 173L472 77C432.235 62.0883 367.765 62.0883 328 77L72 173C51.3227 180.754 41.3975 191.013 42.2245 201.172V151.172Z" fill="#6580E1"/>
      <g filter="url(#filter5_d_1_154)">
      <path d="M328 27C367.764 12.0883 432.236 12.0883 472 27L728 123C767.764 137.912 767.764 162.088 728 177L472 273C432.235 287.912 367.765 287.912 328 273L72 177C32.2355 162.088 32.2355 137.912 72 123L328 27Z" fill="#6580E1"/>
      </g>
      </g>
      <defs>
      <filter id="filter0_d_1_154" x="126.177" y="231.816" width="715.647" height="318.367" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
      <feFlood flood-opacity="0" result="BackgroundImageFix"/>
      <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
      <feOffset/>
      <feComposite in2="hardAlpha" operator="out"/>
      <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/>
      <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1_154"/>
      <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1_154" result="shape"/>
      </filter>
      <filter id="filter1_d_1_154" x="122.177" y="231.816" width="723.647" height="276.367" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
      <feFlood flood-opacity="0" result="BackgroundImageFix"/>
      <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
      <feOffset dy="4"/>
      <feGaussianBlur stdDeviation="2"/>
      <feComposite in2="hardAlpha" operator="out"/>
      <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/>
      <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1_154"/>
      <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1_154" result="shape"/>
      </filter>
      <filter id="filter2_d_1_154" x="84.1767" y="123.816" width="715.647" height="318.367" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
      <feFlood flood-opacity="0" result="BackgroundImageFix"/>
      <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
      <feOffset/>
      <feComposite in2="hardAlpha" operator="out"/>
      <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/>
      <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1_154"/>
      <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1_154" result="shape"/>
      </filter>
      <filter id="filter3_d_1_154" x="80.1767" y="123.816" width="723.647" height="276.367" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
      <feFlood flood-opacity="0" result="BackgroundImageFix"/>
      <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
      <feOffset dy="4"/>
      <feGaussianBlur stdDeviation="2"/>
      <feComposite in2="hardAlpha" operator="out"/>
      <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/>
      <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1_154"/>
      <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1_154" result="shape"/>
      </filter>
      <filter id="filter4_d_1_154" x="42.1767" y="15.8162" width="715.647" height="318.367" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
      <feFlood flood-opacity="0" result="BackgroundImageFix"/>
      <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
      <feOffset/>
      <feComposite in2="hardAlpha" operator="out"/>
      <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/>
      <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1_154"/>
      <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1_154" result="shape"/>
      </filter>
      <filter id="filter5_d_1_154" x="38.1767" y="15.8162" width="723.647" height="276.367" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
      <feFlood flood-opacity="0" result="BackgroundImageFix"/>
      <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
      <feOffset dy="4"/>
      <feGaussianBlur stdDeviation="2"/>
      <feComposite in2="hardAlpha" operator="out"/>
      <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/>
      <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1_154"/>
      <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1_154" result="shape"/>
      </filter>
      </defs>
    </svg>

    
  </section>

 <section bind:this={about} class="about">
    <div class="intro">
    </div>
  </section>

  <section bind:this={projects} class="projects">
        <h1 class="example">Projects Made:</h1>

        <div class="buoy project-holder">
          <img class="left" src="src\lib\img\buoy-snapshot.jpeg" alt="Buoy Snapshot" style="width: 40%; height: auto;">

          <div class="right project-info">
            <h1>Buoy</h1>
            <h5>A Project by SLSU Turing Machines (BSCpE III - GF)</h5>
            <p>Lorem ipsum sit dolor amet.</p>
          </div>
        </div>

        <div class="tra project-holder">
          <img class="left" src="src\lib\img\buoy-snapshot.jpeg" alt="TypeRush Snapshot" style="width: 40%; height: auto;">

          <div class="right project-info">
            <h1>TypeRush Arena</h1>
            <h5>A Mobile Development (Android Studio) Project.</h5>
            <p>Lorem ipsum sit dolor amet.</p>
          </div>
        </div>
  </section>

  <section bind:this={contact} class="contact">
    <div class="intro"></div>
  </section>
</div>

<script>
  import { onMount } from 'svelte';
  import { scrollTarget, headerObj } from '$lib/stores/scrollTarget.js';
  import { tick } from 'svelte';
  import { animate, text, stagger, createTimeline, onScroll } from 'animejs';
	import Header from '$lib/Components/Header.svelte';
  let home;
  let about;
  let projects;
  let contact;
  let heading1, heading2, heading3, heading4;
 
  onMount(async () => {
    await tick(); // ensures DOM is updated
    
    scrollTarget.set({ home, about, projects, contact });
    await tick();
        const elements = [heading1, heading2, heading3, heading4];

      const allWords = elements.flatMap(el => text.split(el, {
        words: { wrap: 'hidden' }
      }).words);

      animate(allWords, {
      y: [
        { to: ['100%', '0%'] }
      ],
      duration: 750,
      ease: 'out(3)',
      delay: stagger(300),
      loop: false
    });

    await tick();

    const layers = document.querySelectorAll('.layer');
    const tl = createTimeline({
      loop: true,
      ease: 'cubicBezier(0.175, 0.885, 0.32, 1.75)',
      defaults: {
        duration: 500,
      },
    });

    layers.forEach((layer, i) => {
      const label = `wave${i}`;
      const delay = i * 200;

      tl.label(label, delay)
        .add(
          layer,
          {
            translateY: -20,
            translateX: 30
          },
          label
        )
        .add(
          layer,
          {
            translateY: 0,
            translateX: 0
          },
          `<+=0` // back down after 750ms
        );
    });

    await tick();

    animate('.image-position', {
      translateX: [500, 0],
      duration: 1200,
      ease: 'cubicBezier(0.21, 0.75, 0.53, 1.4)',
      complete: () => {
        animate('.image-container img', {
          translateY: [30, 0],
          opacity: [0, 1],
          duration: 1200,
          delay: 1200,
          ease: 'cubicBezier(0.21, 0.75, 0.53, 1)'
        });
      }
    });

    await tick();

    // Create a reusable function that returns shared animation settings
    animateProjectBlock({
    leftSelector: '.buoy .left',
    rightSelector: '.buoy .right',
    targetSelector: '.buoy'
  });

  animateProjectBlock({
    leftSelector: '.tra .left',
    rightSelector: '.tra .right',
    targetSelector: '.tra'
  });

  function animateProjectBlock({ leftSelector, rightSelector, targetSelector }) {
  const target = document.querySelector(targetSelector);
  if (!target) return;

  animate(leftSelector, {
    translateX: [-200, 0],
    translateY: [100, 0],
    duration: 1000,
    ease: 'cubicBezier(0.68, 0.32, 0.37, 0.98)',
    autoplay: onScroll({
      target,
      enter: 'bottom-=0 top',
      leave: 'top+=700 bottom',
      sync: 0.25,
      debug: true
    })
  });

  animate(rightSelector, {
    translateX: [200, 0],
    translateY: [100, 0],
    duration: 1000,
    ease: 'cubicBezier(0.68, 0.32, 0.37, 0.98)',
    autoplay: onScroll({
      target,
      enter: 'bottom-=0 top',
      leave: 'top+=700 bottom',
      sync: 0.25,
      debug: true
    })
  });

  animate(`${rightSelector} > *`, {
    translateY: [20, 0],
    opacity: [0, 1],
    duration: 1000,
    delay: stagger(300),
    ease: 'cubicBezier(0.68, 0.32, 0.37, 0.98)',
    autoplay: onScroll({
      target,
      enter: 'center top-=100',
      leave: 'center top-=99',
      sync: 0.25,
      debug: true
    })
  });
}


    await tick();
    animate($headerObj,{
      width: '100%',
      marginTop: '0px',
      borderRadius: '0px',
      ease: 'easeInOutExpo',
      autoplay: onScroll({
        target: '.about',
        enter: 'bottom-=0 top',
        leave: 'top+=700 bottom-=700',
        sync: 0.5,
        debug: true
      })
    })
  });
</script>

<style>

  .example{
    display: block;
    width: fit-content;
    margin: 0 auto;
    font-family: 'Inter', sans-serif;
    font-size: 30px;
    color: white;
    margin-bottom: 50px;
  }

  .project-holder{
    display: flex;
    width: 80%;
    justify-content: space-between;
    align-items: center;
    margin: 0 auto;
    margin-bottom: 40px;
  }
  .project-info{
    color: white;
    font-family: 'Inter', sans-serif;
    text-align: end;
  }

  .left {
    background-color: white;
    border-radius: 0 20px 0 20px;
    display: inline-block;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2); /* Optional shadow */
    transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    cursor: pointer;
  }

  .left:hover{
    transform: scale(1.1) !important;
  }

  .container{
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    justify-content: center;
  }
  .main, .about, .projects, .contact {
    width: 100%;
    height: 100dvh;
    padding: 3%;
    position: relative;
    overflow: hidden;
  }

  .main{
    background: linear-gradient(to right, #ff7e5f, #feb47b);
    display: flex;
    justify-content: flex-start;
    align-items: center;
    font-family: 'Inter', sans-serif;
  }

  svg{
    position:absolute;
    width: 30%;
    left: -10%;
    bottom: -10%;
    height: auto;
    overflow: visible;
  }

  .about{
    background: linear-gradient(to right, #6a11cb, #2575fc);
  }

  .projects{
    background: linear-gradient(to right, #00c6ff, #0072ff);
  }

  .contact{
    background: linear-gradient(to right, #ff416c, #ff4b2b);
  }

  .info h1{
    font-size: 3rem;
  }

  .info-container{
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
  }

  .image-position{
    width: 20vw;
    height: auto;
    aspect-ratio: 1 / 1;
  }
.image-container {
  width: 100%;
  height: 100%;
  background-color: #f8fbf8;
  border: 2px solid black;
  border-radius: 50%;
  overflow: hidden;
}

.image-container img {
  width: 100%;
  height: 100%;
  display: block;
}

</style>